/* Internationalization (i18n) for Medicaid Fraud Detection Site */

const I18n = {
    currentLang: localStorage.getItem('lang') || 'it',

    translations: {
        it: {
            // === NAVBAR ===
            'nav.methodology': 'Metodologia',
            'nav.overview': 'Overview',
            'nav.benford': 'Benford',
            'nav.outliers': 'Outliers',
            'nav.billing': 'Billing',
            'nav.temporal': 'Temporale',
            'nav.volume': 'Volume',
            'nav.risk': 'Risk Score',
            'nav.provider': 'Provider',

            // === COMMON ===
            'loading': 'Caricamento dati...',
            'noData': 'Nessun dato disponibile',
            'noNetworkData': 'Nessun dato di rete disponibile',

            // === INDEX PAGE ===
            'index.title': 'Medicaid Provider Spending: Fraud Detection System',
            'index.subtitle': 'Analisi statistica multi-dimensionale per l\'identificazione di anomalie e potenziali frodi nei dati di spesa Medicaid del Centers for Medicare & Medicaid Services (CMS).',
            'index.stat.spend': 'Spesa Analizzata',
            'index.stat.providers': 'Provider',
            'index.stat.claims': 'Claims',
            'index.stat.risk': 'Alto Rischio',

            'index.toc.title': 'Indice',
            'index.toc.1': 'Dataset e Preprocessing',
            'index.toc.2': 'Architettura del Sistema',
            'index.toc.3': 'Le 6 Tecniche di Rilevamento',
            'index.toc.3a': 'Legge di Benford',
            'index.toc.3b': 'Outlier Statistici (Z-Score, IQR, Isolation Forest)',
            'index.toc.3c': 'Billing Mismatch',
            'index.toc.3d': 'Anomalie Temporali',
            'index.toc.3e': 'Anomalie di Volume',
            'index.toc.3f': 'Risk Score Composito',
            'index.toc.4': 'Principali Risultati',
            'index.toc.5': 'Conclusioni e Ipotesi Investigative',
            'index.toc.6': 'Limiti dell\'Analisi',
            'index.toc.7': 'Navigazione delle Analisi',

            // Section 1: Dataset
            'index.s1.title': '1. Dataset e Preprocessing',
            'index.s1.intro': 'Il dataset analizzato proviene dal <strong>CMS Medicaid Provider Spending</strong>, disponibile pubblicamente su <a href="https://opendata.hhs.gov/datasets/medicaid-provider-spending/" target="_blank" rel="noopener">opendata.hhs.gov/datasets/medicaid-provider-spending/</a>. Riporta i pagamenti aggregati per combinazione di provider (NPI), procedura (HCPCS) e mese. Ogni record rappresenta quanto un provider ha fatturato per una specifica procedura in un dato mese.',
            'index.s1.structure': 'Struttura dei dati grezzi',
            'index.s1.th.field': 'Campo',
            'index.s1.th.desc': 'Descrizione',
            'index.s1.billing_npi': 'NPI del provider che ha emesso la fattura',
            'index.s1.servicing_npi': 'NPI del provider che ha erogato il servizio',
            'index.s1.hcpcs': 'Codice della procedura medica (Healthcare Common Procedure Coding System)',
            'index.s1.month': 'Mese di riferimento del claim (YYYY-MM)',
            'index.s1.paid': 'Importo totale pagato ($)',
            'index.s1.claims': 'Numero di claims',
            'index.s1.bene': 'Numero di beneficiari unici',
            'index.s1.preproc': 'Preprocessing',
            'index.s1.preproc.text': 'I dati grezzi vengono caricati in un database analitico (DuckDB) e pre-aggregati in 7 tabelle ottimizzate per l\'analisi:',
            'index.s1.agg1': '<strong>agg_provider_monthly</strong> &mdash; Spesa mensile per provider',
            'index.s1.agg2': '<strong>agg_provider_hcpcs</strong> &mdash; Spesa per provider &times; procedura, con metriche derivate (costo/claim, costo/beneficiario, claims/beneficiario)',
            'index.s1.agg3': '<strong>agg_hcpcs_stats</strong> &mdash; Statistiche per procedura (media, std, mediana, Q1, Q3) calcolate su tutti i provider con &ge;5 provider per HCPCS',
            'index.s1.agg4': '<strong>agg_billing_servicing</strong> &mdash; Relazioni billing/servicing e percentuali di mismatch',
            'index.s1.agg5': '<strong>agg_benford</strong> &mdash; Distribuzione della prima cifra degli importi per provider e HCPCS',
            'index.s1.agg6': '<strong>agg_provider_summary</strong> &mdash; Profilo complessivo di ogni provider',
            'index.s1.agg7': '<strong>provider_risk_scores</strong> &mdash; Punteggi di rischio compositi (calcolati dal sistema)',
            'index.s1.filters': 'Filtri applicati: <code>TOTAL_PAID &gt; 0</code>, <code>TOTAL_CLAIMS &gt; 0</code>, <code>BILLING_PROVIDER_NPI_NUM IS NOT NULL</code>.',

            // Section 2: Architecture
            'index.s2.title': '2. Architettura del Sistema',
            'index.s2.intro': 'Il sistema segue un\'architettura <strong>pre-compute + static site</strong>:',
            'index.s2.step1': '<strong>Ingestione</strong> &mdash; Il CSV grezzo (~11 GB) viene caricato in DuckDB con creazione di tabelle aggregate e indici.',
            'index.s2.step2': '<strong>Calcolo Risk Score</strong> &mdash; 8 componenti di rischio vengono calcolate e normalizzate a percentile (0-100) per ogni provider.',
            'index.s2.step3': '<strong>Pre-computazione</strong> &mdash; Tutte le analisi vengono eseguite in parallelo (7 sezioni concorrenti + 50 dettagli provider) e salvate come file JSON.',
            'index.s2.step4': '<strong>Sito statico</strong> &mdash; Le pagine HTML caricano i JSON e li visualizzano con Plotly.js, Bootstrap 5 e DataTables. Zero backend, zero database in produzione.',
            'index.s2.perf': 'L\'intero processo di pre-computazione richiede circa <strong>25 secondi</strong> su hardware con DuckDB multi-core.',

            // Section 3: Techniques
            'index.s3.title': '3. Le 6 Tecniche di Rilevamento Frode',

            // 3a Benford
            'index.s3a.title': '3a. Legge di Benford',
            'index.s3a.weight': 'Peso nel Risk Score: 10%',
            'index.s3a.badge': 'ANALISI DISTRIBUZIONALE',
            'index.s3a.text1': 'La <strong>Legge di Benford</strong> (o Legge della Prima Cifra) stabilisce che in molti dataset naturali, la prima cifra significativa non e\' uniformemente distribuita ma segue una distribuzione logaritmica:',
            'index.s3a.text2': 'La cifra "1" appare come prima cifra nel ~30.1% dei casi, "2" nel ~17.6%, e cosi\' via fino a "9" con ~4.6%. Dati manipolati artificialmente (importi inventati, arrotondati, o duplicati) tendono a deviare da questa distribuzione.',
            'index.s3a.metrics': 'Metriche calcolate',
            'index.s3a.mad': '<strong>MAD (Mean Absolute Deviation)</strong> &mdash; Media delle deviazioni assolute tra frequenza osservata e attesa per ciascuna delle 9 cifre. Valori &gt; 0.015 sono considerati "non conformi", &gt; 0.03 "significativamente devianti".',
            'index.s3a.chi2': '<strong>Test Chi-Quadro (&chi;&sup2;)</strong> &mdash; Test di bonta\' di adattamento con 8 gradi di liberta\'. Un p-value &lt; 0.05 indica deviazione statisticamente significativa dalla Legge di Benford.',
            'index.s3a.levels': 'Livelli di analisi',
            'index.s3a.global': '<strong>Globale</strong> &mdash; Distribuzione complessiva di tutti gli importi',
            'index.s3a.hcpcs': '<strong>Per HCPCS</strong> &mdash; Ogni procedura analizzata separatamente (minimo 100 record)',
            'index.s3a.provider': '<strong>Per Provider</strong> &mdash; Ogni provider analizzato separatamente (minimo 50 record)',
            'index.s3a.interp': '<strong>Interpretazione:</strong> Un provider con MAD elevato potrebbe avere importi non organici (inventati, arrotondati sistematicamente, o copiati). Tuttavia, deviazioni da Benford possono avere spiegazioni legittime (es. tariffe fisse, arrotondamenti di sistema). Per questo il Benford ha peso moderato (10%) nel risk score composito.',

            // 3b Outliers
            'index.s3b.title': '3b. Outlier Statistici',
            'index.s3b.weight': 'Peso: Z-Score 20% + Isolation Forest 15% = 35%',
            'index.s3b.badge': 'ANALISI STATISTICA',
            'index.s3b.text1': 'Tre metodi complementari identificano provider che fatturano importi anomali rispetto ai loro colleghi per la stessa procedura:',
            'index.s3b.zscore.title': 'Z-Score (peso 20%)',
            'index.s3b.zscore.text1': 'Misura quante deviazioni standard un provider dista dalla media della sua procedura:',
            'index.s3b.zscore.text2': 'Provider con |Z| &gt; 3 sono flaggati come outlier (probabilita\' &lt; 0.3% in distribuzione normale). Il sistema calcola Z-score sia su <code>cost_per_claim</code> che su <code>cost_per_beneficiary</code>. Il risk score usa il massimo |Z| tra tutte le procedure di un provider.',
            'index.s3b.iqr.title': 'Metodo IQR di Tukey',
            'index.s3b.iqr.text1': 'Metodo non-parametrico robusto agli outlier stessi. Definisce le "fences":',
            'index.s3b.iqr.text2': 'Valori oltre le fences sono outlier. Questo metodo e\' complementare allo Z-score perche\' non assume normalita\'.',
            'index.s3b.if.title': 'Isolation Forest (peso 15%)',
            'index.s3b.if.text1': 'Algoritmo di machine learning non supervisionato (ensemble di alberi decisionali). Isola le osservazioni anomale: punti facili da isolare (pochi split necessari) sono piu\' anomali.',
            'index.s3b.if.feat1': 'Feature utilizzate: <code>cost_per_claim</code>, <code>cost_per_beneficiary</code>, <code>claims_per_beneficiary</code>, <code>total_paid</code>',
            'index.s3b.if.feat2': 'Trasformazione log per gestire la skewness',
            'index.s3b.if.feat3': 'Contamination = 5% (il modello si aspetta che ~5% dei dati siano anomali)',
            'index.s3b.interp': '<strong>Interpretazione:</strong> Provider flaggati da tutti e tre i metodi hanno una probabilita\' molto alta di avere pattern di fatturazione anomali. Le cause possono essere upcoding (fatturare procedure piu\' costose di quelle erogate), unbundling (separare una procedura in piu\' claims), o frode diretta.',

            // 3c Billing
            'index.s3c.title': '3c. Billing Mismatch',
            'index.s3c.weight': 'Peso nel Risk Score: 10%',
            'index.s3c.badge': 'ANALISI RELAZIONALE',
            'index.s3c.text1': 'Analizza le discrepanze tra il <strong>NPI di fatturazione</strong> (chi emette la fattura) e il <strong>NPI di servizio</strong> (chi eroga la prestazione). In scenari legittimi, il billing NPI puo\' essere un gruppo medico o una struttura. In scenari fraudolenti, un singolo NPI puo\' fatturare per decine di provider inesistenti.',
            'index.s3c.indicators': 'Indicatori',
            'index.s3c.hubs': '<strong>Billing Hubs</strong> &mdash; NPI di fatturazione associati a molti NPI di servizio diversi. Un billing NPI con 10+ servicing NPI e\' sospetto.',
            'index.s3c.pctmm': '<strong>% Mismatch</strong> &mdash; Percentuale di spesa dove billing &ne; servicing. Alta percentuale suggerisce intermediazione anomala.',
            'index.s3c.lorenz': '<strong>Curva di Lorenz</strong> &mdash; Misura la concentrazione: se pochi provider generano la maggior parte del mismatch, il pattern e\' piu\' sospetto.',
            'index.s3c.network.title': 'Rete Billing-Servicing',
            'index.s3c.network.text': 'Le relazioni sono visualizzate come un grafo dove i nodi sono NPI e gli archi rappresentano fatturazioni incrociate. Nodi centrali con molte connessioni ("hub") sono potenziali punti di frode organizzata.',
            'index.s3c.interp': '<strong>Interpretazione:</strong> Il mismatch di per se\' non e\' illecito (es. laboratori, gruppi medici). Diventa sospetto quando combinato con alti volumi, pochi mesi di attivita\', e costi anomali.',

            // 3d Temporal
            'index.s3d.title': '3d. Anomalie Temporali',
            'index.s3d.weight': 'Peso: Spike 15% + Ghost 10% = 25%',
            'index.s3d.badge': 'ANALISI SERIE STORICHE',
            'index.s3d.text1': 'Quattro sotto-analisi esaminano il comportamento temporale di ogni provider:',
            'index.s3d.spike.title': 'Spike Detection (peso 15%)',
            'index.s3d.spike.text1': 'Identifica aumenti improvvisi della spesa mese su mese:',
            'index.s3d.spike.text2': 'Un provider con un aumento &gt;300% in un mese e\' flaggato. Il sistema calcola anche uno Z-score rolling (finestra 6 mesi) per contestualizzare lo spike rispetto alla volatilita\' storica del provider.',
            'index.s3d.ghost.title': 'Ghost Providers (peso 10%)',
            'index.s3d.ghost.text1': 'Provider attivi per un periodo molto breve ma con fatturato elevato:',
            'index.s3d.ghost.rule1': '&le; 3 mesi + &ge; $500K &rarr; Score 100 (massimo rischio)',
            'index.s3d.ghost.rule2': '&le; 6 mesi + &ge; $500K &rarr; Score 80',
            'index.s3d.ghost.rule3': '&le; 6 mesi + &ge; $100K &rarr; Score 50',
            'index.s3d.ghost.rule4': '&le; 12 mesi + &ge; $500K &rarr; Score 30',
            'index.s3d.ghost.text2': 'Questo pattern ("mordi e fuggi") e\' uno degli indicatori piu\' forti di frode: il provider appare, fattura rapidamente importi elevati, e scompare prima che i controlli possano attivarsi.',
            'index.s3d.disapp.title': 'Provider Scomparsi',
            'index.s3d.disapp.text': 'Provider che hanno interrotto l\'attivita\' almeno 6 mesi prima della fine dei dati, con almeno $100K di fatturato e 3+ mesi di attivita\'. La scomparsa improvvisa puo\' indicare chiusura a seguito di indagini o fuga dopo attivita\' fraudolenta.',
            'index.s3d.seasonal.title': 'Deviazioni Stagionali',
            'index.s3d.seasonal.text': 'Mesi in cui la spesa di un provider devia &gt;2 deviazioni standard dalla propria media storica. Richiede almeno 6 mesi di attivita\'.',

            // 3e Volume
            'index.s3e.title': '3e. Anomalie di Volume',
            'index.s3e.weight': 'Peso: Claims/Bene 10% + Concentrazione 10% = 20%',
            'index.s3e.badge': 'ANALISI VOLUMETRICA',
            'index.s3e.text1': 'Due indicatori analizzano i volumi di attivita\':',
            'index.s3e.cpb.title': 'Claims per Beneficiario (peso 10%)',
            'index.s3e.cpb.text1': 'Rapporto tra il numero di claims di un provider per una procedura e la mediana della stessa procedura su tutti i provider:',
            'index.s3e.cpb.text2': 'Un ratio &gt; 3x indica che il provider sta generando un numero sproporzionato di claims per beneficiario rispetto ai colleghi. Puo\' indicare <strong>unbundling</strong> (suddivisione di una procedura in piu\' claims separati) o <strong>phantom billing</strong> (claims per servizi mai erogati).',
            'index.s3e.hhi.title': 'Concentrazione di Procedura - Indice HHI (peso 10%)',
            'index.s3e.hhi.text1': 'L\'Herfindahl-Hirschman Index misura quanto il fatturato di un provider e\' concentrato su poche procedure:',
            'index.s3e.hhi.rule1': 'HHI = 1.0 &rarr; 100% della spesa su una sola procedura',
            'index.s3e.hhi.rule2': 'HHI &gt; 0.8 &rarr; Concentrazione estrema (sospetto)',
            'index.s3e.hhi.rule3': 'HHI &lt; 0.25 &rarr; Diversificato (tipico di pratiche legittime)',
            'index.s3e.hhi.text2': 'Un provider che fattura milioni su una sola procedura e\' piu\' sospetto di uno con un mix diversificato, specialmente se combinato con costi per claim anomali.',

            // 3f Risk Score
            'index.s3f.title': '3f. Risk Score Composito',
            'index.s3f.weight': 'Scala 0-100',
            'index.s3f.badge': 'SCORE AGGREGATO',
            'index.s3f.text1': 'Ogni provider riceve un punteggio di rischio composito (0-100) che combina tutte le analisi precedenti. Ogni componente viene prima <strong>normalizzato a percentile</strong> (rank percentile 0-100 sull\'intera popolazione) e poi pesato:',
            'index.s3f.th.component': 'Componente',
            'index.s3f.th.weight': 'Peso',
            'index.s3f.th.metric': 'Metrica base',
            'index.s3f.m1': 'MAX(|Z-score|) tra tutte le procedure',
            'index.s3f.m2': 'Anomaly score normalizzato',
            'index.s3f.m3': 'MAX spike mese-su-mese',
            'index.s3f.m4': 'MAD dalla distribuzione attesa',
            'index.s3f.m5': '% spesa con billing &ne; servicing',
            'index.s3f.m6': 'Heuristic (mesi &times; fatturato)',
            'index.s3f.m7': 'MAX ratio vs mediana HCPCS',
            'index.s3f.m8': 'HHI del mix procedure',
            'index.s3f.threshold': '<strong>Soglia di alto rischio: &ge; 70/100.</strong> Provider sopra questa soglia presentano anomalie significative in piu\' dimensioni contemporaneamente.',
            'index.s3f.percentile': '<strong>Nota sulla normalizzazione a percentile:</strong> Un percentile di 95 significa che il provider ha un valore piu\' alto del 95% della popolazione per quella metrica. Questo rende le componenti confrontabili anche se hanno scale molto diverse (es. dollari vs rapporti).',

            // Section 4: Results
            'index.s4.title': '4. Principali Risultati',
            'index.s4.r1.title': '18,612 provider ad alto rischio (3.1%)',
            'index.s4.r1.text': 'Su 594,244 provider analizzati, 18,612 hanno un risk score &ge; 70, indicando anomalie consistenti su piu\' dimensioni. La media del risk score e\' 47.1, la mediana 47.1 &mdash; distribuzione approssimativamente normale centrata a meta\' scala.',
            'index.s4.r2.title': 'Benford: conformita\' globale, deviazioni locali',
            'index.s4.r2.text': 'Il test &chi;&sup2; risulta significativo (&chi;&sup2; = 227,151, p &asymp; 0) ma per puro effetto campionario (~190M osservazioni). Il <strong>MAD globale e\' 0.0034</strong>, che indica <strong>conformita\' stretta</strong> a Benford (soglia Nigrini: &lt;0.006). La distribuzione aggregata e\' sostanzialmente normale. Le deviazioni sono concentrate su specifici provider e codici HCPCS: 200 provider e 200 codici mostrano MAD elevato, suggerendo pattern di importi non organici a livello locale.',
            'index.s4.r3.title': '200 Ghost Providers con pattern "mordi e fuggi"',
            'index.s4.r3.text': '200 provider sono stati attivi per 6 mesi o meno con fatturati superiori a $500K. Il caso piu\' eclatante: un singolo provider ha fatturato $48.3M in soli 6 mesi (luglio-dicembre 2022) prima di cessare l\'attivita\'.',
            'index.s4.r4.title': '$320 miliardi (29.3%) in billing mismatch',
            'index.s4.r4.text': 'Il 24.5% dei provider (145,485) ha discrepanze tra NPI di fatturazione e NPI di servizio, per un totale di $320 miliardi. I top "billing hub" gestiscono relazioni con decine di NPI di servizio ciascuno.',
            'index.s4.r5.title': 'Provider con concentrazione estrema',
            'index.s4.r5.text': 'Numerosi provider ad alto fatturato operano su una singola procedura (HHI = 1.0) con costi per claim molto superiori alla media. Questo pattern e\' consistente con upcoding sistematico o specializzazione in procedure ad alto rimborso.',

            // Section 5: Conclusions
            'index.s5.title': '5. Conclusioni e Ipotesi Investigative',
            'index.s5.intro': 'L\'analisi multidimensionale condotta su 594,244 provider e oltre $1 trilione di pagamenti Medicaid ha evidenziato pattern statisticamente anomali che, considerati nel loro complesso, delineano alcune ipotesi investigative concrete.',
            'index.s5.h1.title': 'Ipotesi 1: Rete organizzata di fatturazione fittizia tramite Billing Hub',
            'index.s5.h1.text': '<p>Il provider con il maggior numero di NPI di servizio associati (NPI 1679525919) gestisce <strong>5,716 NPI servicing</strong> per un totale di <strong>$863 milioni</strong> di fatturato. I primi 3 billing hub da soli canalizzano oltre <strong>$1.37 miliardi</strong>.</p><p>Il 24.5% dei provider (145,485) presenta discrepanze tra NPI di fatturazione e NPI di servizio, per un totale di <strong>$320 miliardi</strong> (29.3% della spesa totale). Il 35.3% dei claim totali transita attraverso questi canali.</p><p><strong>Ipotesi:</strong> Alcuni billing hub potrebbero fungere da "shell entity" che aggregano fatturazioni per conto di provider fittizi o inesistenti. Il numero abnorme di NPI servicing associati a un singolo NPI billing suggerisce un modello organizzativo progettato per frammentare e rendere meno visibile il volume di fatturazione complessivo. Questo schema e\' coerente con pattern documentati di <em>billing mill fraud</em>.</p><p class="mb-0"><strong>Azione suggerita:</strong> Verifica incrociata dei top 200 billing hub con il registro NPPES per accertare che gli NPI servicing corrispondano a professionisti reali e attivi, con indirizzo fisico verificabile.</p>',
            'index.s5.h2.title': 'Ipotesi 2: "Ghost Providers" con schema mordi-e-fuggi',
            'index.s5.h2.text': '<p>200 provider sono stati attivi per <strong>6 mesi o meno</strong> con fatturati superiori a $500K. Il caso piu\' significativo: NPI 1922733641 ha fatturato <strong>$48.3 milioni in 6 mesi</strong> (luglio-dicembre 2022, costo medio per claim: $666) prima di cessare l\'attivita\'. Un secondo provider (NPI 1215634928) ha fatturato $22.3 milioni in 6 mesi.</p><p><strong>Ipotesi:</strong> Il pattern "alta intensita\' in finestra temporale breve seguita da cessazione improvvisa" e\' un indicatore classico di <em>phantom billing</em>. Il provider viene registrato, fattura intensamente per pochi mesi &mdash; tipicamente sotto la soglia di audit annuale &mdash; e poi scompare prima che i controlli possano attivarsi. La concentrazione di molti ghost provider nel periodo 2022-2023 suggerisce un possibile pattern sistematico piuttosto che casi isolati.</p><p class="mb-0"><strong>Azione suggerita:</strong> Analisi dei beneficiari associati a questi provider per verificare se gli stessi pazienti compaiono anche sotto altri NPI ghost, il che indicherebbe un circuito di <em>patient recycling</em>.</p>',
            'index.s5.h3.title': 'Ipotesi 3: Upcoding sistematico su procedure ad alto rimborso',
            'index.s5.h3.text': '<p>Provider con indice di concentrazione HHI prossimo a 1.0 (mono-procedura) generano fatturati nell\'ordine dei <strong>miliardi</strong>: NPI 1376609297 ha un HHI di 0.96 con $5.57 miliardi su essenzialmente una sola procedura. I top 3 provider per concentrazione fatturano complessivamente $10.28 miliardi.</p><p>Parallelamente, l\'analisi Z-Score e IQR identifica migliaia di outlier per le procedure T1019, T1015, T2016 e 99213 &mdash; procedure frequentemente associate a <em>home health services</em> e visite ambulatoriali.</p><p><strong>Ipotesi:</strong> La combinazione di concentrazione estrema su una singola procedura e costo medio per claim significativamente superiore alla media di quella procedura e\' consistente con <em>upcoding</em> (fatturazione di una procedura a un livello di complessita\'/rimborso superiore a quello effettivo) o con <em>unbundling</em> (scomposizione di un servizio in piu\' claim separati per massimizzare il rimborso).</p><p class="mb-0"><strong>Azione suggerita:</strong> Confronto dei codici HCPCS fatturati da questi provider con la loro specializzazione medica registrata. Un dermatologo che fattura esclusivamente procedure cardiovascolari ad alto costo, ad esempio, costituirebbe una "red flag" inequivocabile.</p>',
            'index.s5.h4.title': 'Ipotesi 4: Manipolazione degli importi (deviazione Benford)',
            'index.s5.h4.text': '<p>La distribuzione globale della prima cifra devia significativamente dalla Legge di Benford (&chi;&sup2; = 227,151, p &asymp; 0). I 200 provider con la maggiore deviazione (MAD > 0.19) mostrano distribuzioni della prima cifra radicalmente diverse da quelle attese, con sovra-rappresentazione di cifre specifiche.</p><p><strong>Ipotesi:</strong> Importi inventati o manipolati tendono a non seguire la distribuzione naturale di Benford. Un provider che fattura importi ripetitivi (es. sempre $999, $4,500, $8,000) genera una distribuzione della prima cifra "piatta" o concentrata, nettamente distinguibile da una distribuzione organica. Questo pattern e\' particolarmente rilevante quando coincide con altri indicatori di rischio (ghost provider, alta concentrazione, spike temporali).</p><p class="mb-0"><strong>Azione suggerita:</strong> Audit dei claim grezzi per i provider con MAD > 0.15 per verificare la presenza di importi ripetitivi, arrotondamenti sospetti, o cluster di importi identici.</p>',
            'index.s5.h5.title': 'Ipotesi 5: Convergenza multi-dimensionale come prioritizzazione',
            'index.s5.h5.text': '<p>Il provider a piu\' alto rischio (NPI 1972688919, score 89.8/100) presenta anomalie <strong>su tutte le 8 dimensioni contemporaneamente</strong>: Benford (69.5), Z-Score (98.2), Isolation Forest (99.4), Billing Mismatch (87.4), Spike Temporale (93.8), Ghost Provider (99.4), Claims/Beneficiario (95.3), Concentrazione (60.1). Il suo fatturato totale e\' di $52.1 milioni.</p><p>I top 5 provider per risk score hanno tutti score superiore a 88.9 e cumulano un fatturato di circa $145 milioni.</p><p><strong>Conclusione:</strong> La probabilita\' che un singolo provider risulti anomalo su 8 dimensioni indipendenti per puro caso e\' estremamente bassa. La convergenza di indicatori multipli costituisce la base piu\' solida per la prioritizzazione degli audit. I 18,612 provider con score &ge; 70 (3.1% del totale) dovrebbero essere l\'obiettivo primario di investigazioni approfondite.</p><p class="mb-0"><strong>Stima impatto potenziale:</strong> Se anche solo il 10% dei $320 miliardi in billing mismatch fosse riconducibile a fatturazione impropria, si tratterebbe di circa <strong>$32 miliardi</strong> di potenziale spreco o frode.</p>',

            // Section 6: Limitations
            'index.s6.title': '6. Limiti dell\'Analisi',
            'index.s6.subtitle': 'Cosa questa analisi NON e\'',
            'index.s6.l1': '<strong>Non e\' una prova di frode.</strong> Ogni anomalia statistica puo\' avere spiegazioni legittime: un provider mono-procedura potrebbe essere un centro specializzato; un ghost provider potrebbe aver semplicemente chiuso l\'attivita\'; un billing hub potrebbe essere un legittimo gruppo ospedaliero.',
            'index.s6.l2': '<strong>Non considera variabili cliniche.</strong> L\'analisi si basa esclusivamente su dati di fatturazione aggregati. Non abbiamo accesso a diagnosi, cartelle cliniche, o outcome dei pazienti.',
            'index.s6.l3': '<strong>I dati sono aggregati per provider-procedura-mese.</strong> Non abbiamo visibilita\' sul singolo claim o sul singolo beneficiario, il che limita la granularita\' dell\'analisi.',
            'index.s6.l4': '<strong>La Legge di Benford ha limiti noti.</strong> Non si applica a distribuzioni troncate, valori con range limitato, o dati con molti zeri. Alcuni codici HCPCS hanno tariffe fisse che naturalmente deviano da Benford.',
            'index.s6.l5': '<strong>I pesi del risk score sono basati su letteratura e giudizio esperto</strong>, non su un modello supervisionato con casi di frode confermata. Un dataset di frodi accertate consentirebbe di calibrare i pesi in modo ottimale.',

            // Section 7: Navigation
            'index.s7.title': '7. Navigazione delle Analisi',
            'index.s7.text': 'Ogni pagina del sito presenta i dati pre-calcolati con grafici interattivi (Plotly.js) e tabelle navigabili con ricerca e ordinamento (DataTables).',
            'index.s7.overview': 'KPI, trend mensile, top HCPCS, top provider a rischio',
            'index.s7.benford': 'Distribuzione prima cifra, deviazioni per HCPCS e provider',
            'index.s7.outliers': 'Z-Score e IQR outliers per procedura',
            'index.s7.billing': 'Mismatch, billing hubs, rete, curva di Lorenz',
            'index.s7.temporal': 'Spike, ghost, scomparsi, deviazioni stagionali',
            'index.s7.volume': 'Claims/beneficiario, concentrazione HHI',
            'index.s7.risk': 'Distribuzione, composizione, correlazione',
            'index.s7.provider': 'Drill-down sui top 50 provider a rischio',
            'index.footer': 'Analisi eseguita su dati CMS Medicaid Provider Spending. I risultati sono indicatori statistici e non costituiscono prova di frode. Ogni anomalia richiede indagini approfondite per determinare se rappresenta attivita\' illecita o ha spiegazioni legittime.',

            // === OVERVIEW PAGE ===
            'overview.title': 'Overview - Medicaid Fraud Detection System',
            'overview.subtitle': 'Panoramica dei dati Medicaid e dei provider a maggior rischio di frode',
            'overview.kpi.spend': 'Spesa Totale',
            'overview.kpi.claims': 'Claims Totali',
            'overview.kpi.providers': 'Provider Totali',
            'overview.kpi.bene': 'Beneficiari',
            'overview.kpi.risk': 'Provider Alto Rischio',
            'overview.trend': 'Trend Mensile',
            'overview.topHcpcs': 'Top 30 Procedure HCPCS per Spesa',
            'overview.topRisk': 'Top 20 Provider a Rischio',

            // === BENFORD PAGE ===
            'benford.title': 'Analisi Legge di Benford',
            'benford.subtitle': 'La Legge di Benford prevede che la prima cifra degli importi segua una distribuzione logaritmica. Deviazioni significative possono indicare manipolazione dei dati.',
            'benford.global': 'Distribuzione Globale Prima Cifra',
            'benford.topHcpcs': 'Top HCPCS per Deviazione (MAD)',
            'benford.topProviders': 'Top Provider per Deviazione (MAD)',
            'benford.chi2.significant': 'Deviazione statisticamente significativa',
            'benford.chi2.compatible': 'Compatibile con Benford',
            'benford.mad.strict': 'Conformita\' stretta',
            'benford.mad.acceptable': 'Conformita\' accettabile',
            'benford.mad.marginal': 'Conformita\' marginale',
            'benford.mad.nonconform': 'Non conforme',
            'benford.chi2.note': 'Nota: il test &chi;&sup2; risulta significativo per effetto della dimensione campionaria (~190 milioni di osservazioni). Con campioni cosi\' grandi, anche deviazioni minime producono p-value prossimi a zero. Il MAD e\' la metrica piu\' appropriata per valutare la conformita\' a Benford su grandi dataset: il valore di {mad} indica che la distribuzione globale e\' sostanzialmente conforme. Le deviazioni rilevanti sono concentrate su specifici provider, non sul dataset aggregato.',

            // === OUTLIERS PAGE ===
            'outliers.title': 'Outlier Statistici per Procedura',
            'outliers.subtitle': 'Provider con costi anomali rispetto alla distribuzione della loro procedura HCPCS (Z-Score > 3 e metodo IQR di Tukey)',
            'outliers.summary': 'Riepilogo Outlier per Top HCPCS',
            'outliers.tab.zscore': 'Z-Score Outliers',
            'outliers.tab.iqr': 'IQR Outliers',

            // === BILLING PAGE ===
            'billing.title': 'Billing Mismatch Analysis',
            'billing.subtitle': 'Analisi delle discrepanze tra NPI di fatturazione e NPI di servizio. Provider con molti NPI servicing associati possono indicare schemi fraudolenti.',
            'billing.kpi.mismatch': 'Provider con Mismatch',
            'billing.kpi.amount': 'Importo Mismatch',
            'billing.kpi.claims': 'Claims Mismatch',
            'billing.topHubs': 'Top Billing Hubs',
            'billing.network': 'Rete Billing-Servicing',
            'billing.lorenz': 'Curva di Lorenz - Concentrazione Mismatch',

            // === TEMPORAL PAGE ===
            'temporal.title': 'Anomalie Temporali',
            'temporal.subtitle': 'Rilevamento di picchi improvvisi, provider fantasma, scomparsi e deviazioni stagionali',
            'temporal.tab.spikes': 'Spike',
            'temporal.tab.ghosts': 'Ghost Provider',
            'temporal.tab.disappeared': 'Scomparsi',
            'temporal.tab.seasonal': 'Stagionalita',

            // === VOLUME PAGE ===
            'volume.title': 'Anomalie di Volume',
            'volume.subtitle': 'Provider con rapporti claims/beneficiario anomali e concentrazione eccessiva su singole procedure (HHI)',
            'volume.tab.cpb': 'Claims/Beneficiario',
            'volume.tab.hhi': 'Concentrazione HHI',

            // === RISK PAGE ===
            'risk.title': 'Provider Risk Score',
            'risk.subtitle': 'Punteggio composito 0-100 basato su 8 componenti. Provider con score &ge;70 sono considerati ad alto rischio.',
            'risk.distribution': 'Distribuzione Risk Score',
            'risk.top10': 'Top 10 Provider - Composizione Score',
            'risk.ranking': 'Ranking Completo',
            'risk.correlation': 'Correlazione tra Componenti',
            'risk.threshold': 'Soglia Alto Rischio',

            // === PROVIDER PAGE ===
            'provider.title': 'Dettaglio Provider',
            'provider.subtitle': 'Analisi approfondita dei top 50 provider a rischio',
            'provider.select.label': 'Seleziona Provider NPI:',
            'provider.select.loading': 'Caricamento...',
            'provider.select.placeholder': '-- Seleziona NPI --',
            'provider.noSelection': 'Seleziona un provider dal menu per visualizzarne il dettaglio',
            'provider.kpi.spend': 'Spesa Totale',
            'provider.kpi.claims': 'Claims',
            'provider.kpi.bene': 'Beneficiari',
            'provider.kpi.hcpcs': 'Procedure HCPCS',
            'provider.kpi.months': 'Mesi Attivi',
            'provider.risk': 'Risk Score Breakdown',
            'provider.timeline': 'Timeline Mensile',
            'provider.procedures': 'Breakdown Procedure',
            'provider.benford': 'Analisi Benford',
            'provider.network': 'Rete Billing-Servicing',
            'provider.dataUnavailable': 'Dati non disponibili per questo provider',
            'provider.benfordUnavailable': 'Dati Benford non disponibili',
            'provider.score.total': 'Score Totale:',
            'provider.mismatch.npis': 'NPI Servicing',
            'provider.mismatch.pct': '% Mismatch Spesa',
            'provider.mismatch.amount': 'Mismatch $',

            // === CHARTS ===
            'chart.observed': 'Osservato',
            'chart.expected': 'Benford atteso',
            'chart.benford.title': 'Distribuzione Prima Cifra vs Legge di Benford',
            'chart.benford.xaxis': 'Prima Cifra',
            'chart.benford.yaxis': 'Frequenza Relativa',
            'chart.lorenz.title': 'Curva di Lorenz - Concentrazione Mismatch',
            'chart.lorenz.xaxis': '% Cumulativa Provider',
            'chart.lorenz.yaxis': '% Cumulativa Importo Mismatch',
            'chart.lorenz.equality': 'Uguaglianza perfetta',
            'chart.network.title': 'Rete Billing-Servicing',
            'chart.network.connections': 'Connessioni',
            'chart.outliers.title': 'Conteggio Outlier per HCPCS',
            'chart.spikes.title': 'Spike Mensili: Spesa vs Variazione %',
            'chart.ghosts.title': 'Ghost Provider: Mesi Attivi vs Spesa',
            'chart.seasonal.title': 'Deviazioni Stagionali (|Z| > 2)',
            'chart.cpb.title': 'Claims/Beneficiario: Rapporto vs Mediana vs Spesa',
            'chart.hhi.title': 'HHI (Concentrazione Procedura) vs Spesa Totale',
            'chart.trend.title': 'Spesa Mensile Totale',
            'chart.risk.count': 'Conteggio',

            // === TABLES ===
            'table.search': 'Cerca:',
            'table.lengthMenu': 'Mostra _MENU_ righe',
            'table.info': '_START_ - _END_ di _TOTAL_',
            'table.first': 'Prima',
            'table.last': 'Ultima',
            'table.next': '>',
            'table.previous': '<',

            // Table column labels
            'col.billing_npi': 'NPI Billing',
            'col.servicing_npi': 'NPI Servicing',
            'col.hcpcs': 'Codice HCPCS',
            'col.month': 'Mese',
            'col.total_paid': 'Spesa Totale',
            'col.total_claims': 'Claims Totali',
            'col.total_beneficiaries': 'Beneficiari',
            'col.total_records': 'Record Totali',
            'col.num_providers': 'N. Provider',
            'col.num_hcpcs': 'N. Procedure',
            'col.num_months': 'N. Mesi',
            'col.num_servicing_npis': 'N. NPI Servicing',
            'col.cost_per_claim': 'Costo/Claim',
            'col.cost_per_beneficiary': 'Costo/Beneficiario',
            'col.claims_per_beneficiary': 'Claims/Beneficiario',
            'col.avg_cost_per_claim': 'Media Costo/Claim',
            'col.std_cost_per_claim': 'Std Costo/Claim',
            'col.z_cost_per_claim': 'Z-Score Costo/Claim',
            'col.z_cost_per_beneficiary': 'Z-Score Costo/Bene',
            'col.mad': 'MAD',
            'col.chi2': 'Chi-Quadro',
            'col.p_value': 'P-Value',
            'col.total_risk_score': 'Risk Score',
            'col.benford_score': 'Benford',
            'col.zscore_severity': 'Z-Score',
            'col.isolation_forest_score': 'Isolation Forest',
            'col.billing_mismatch_score': 'Mismatch',
            'col.temporal_spike_score': 'Spike',
            'col.ghost_provider_score': 'Ghost',
            'col.claims_per_bene_score': 'Claims/Bene',
            'col.concentration_score': 'Concentrazione',
            'col.pct_mismatch_paid': '% Mismatch $',
            'col.pct_mismatch_claims': '% Mismatch Claims',
            'col.mismatch_paid': 'Mismatch $',
            'col.mismatch_claims': 'Mismatch Claims',
            'col.mom_change_pct': 'Variazione MoM %',
            'col.rolling_zscore': 'Z-Score Rolling',
            'col.hhi': 'HHI',
            'col.max_share': 'Max Share',
            'col.top_hcpcs': 'HCPCS Principale',
            'col.ratio_to_median': 'Rapporto vs Mediana',
            'col.first_month': 'Primo Mese',
            'col.last_month': 'Ultimo Mese',
            'col.months_since_last': 'Mesi Inattivo',
            'col.zscore': 'Z-Score',
            'col.avg_paid': 'Media Spesa',
            'col.std_paid': 'Std Spesa',
            'col.z_outlier_count': 'N. Outlier Z',
            'col.iqr_outlier_count': 'N. Outlier IQR',
            'col.share': 'Quota %',
            'col.observed_pct': '% Osservato',
            'col.expected_pct': '% Atteso',
            'col.deviation': 'Deviazione',
            'col.prev_paid': 'Spesa Prec.',
            'col.rolling_avg': 'Media Rolling',
            'col.avg_cost_per_claim_y': 'Media Costo/Claim',
            'col.data_end': 'Fine Dati',
        },

        en: {
            // === NAVBAR ===
            'nav.methodology': 'Methodology',
            'nav.overview': 'Overview',
            'nav.benford': 'Benford',
            'nav.outliers': 'Outliers',
            'nav.billing': 'Billing',
            'nav.temporal': 'Temporal',
            'nav.volume': 'Volume',
            'nav.risk': 'Risk Score',
            'nav.provider': 'Provider',

            // === COMMON ===
            'loading': 'Loading data...',
            'noData': 'No data available',
            'noNetworkData': 'No network data available',

            // === INDEX PAGE ===
            'index.title': 'Medicaid Provider Spending: Fraud Detection System',
            'index.subtitle': 'Multi-dimensional statistical analysis for identifying anomalies and potential fraud in Medicaid spending data from the Centers for Medicare & Medicaid Services (CMS).',
            'index.stat.spend': 'Spending Analyzed',
            'index.stat.providers': 'Providers',
            'index.stat.claims': 'Claims',
            'index.stat.risk': 'High Risk',

            'index.toc.title': 'Table of Contents',
            'index.toc.1': 'Dataset and Preprocessing',
            'index.toc.2': 'System Architecture',
            'index.toc.3': 'The 6 Detection Techniques',
            'index.toc.3a': 'Benford\'s Law',
            'index.toc.3b': 'Statistical Outliers (Z-Score, IQR, Isolation Forest)',
            'index.toc.3c': 'Billing Mismatch',
            'index.toc.3d': 'Temporal Anomalies',
            'index.toc.3e': 'Volume Anomalies',
            'index.toc.3f': 'Composite Risk Score',
            'index.toc.4': 'Key Findings',
            'index.toc.5': 'Conclusions and Investigative Hypotheses',
            'index.toc.6': 'Analysis Limitations',
            'index.toc.7': 'Analysis Navigation',

            // Section 1: Dataset
            'index.s1.title': '1. Dataset and Preprocessing',
            'index.s1.intro': 'The analyzed dataset comes from the <strong>CMS Medicaid Provider Spending</strong>, publicly available at <a href="https://opendata.hhs.gov/datasets/medicaid-provider-spending/" target="_blank" rel="noopener">opendata.hhs.gov/datasets/medicaid-provider-spending/</a>. It reports aggregated payments by combination of provider (NPI), procedure (HCPCS), and month. Each record represents how much a provider billed for a specific procedure in a given month.',
            'index.s1.structure': 'Raw data structure',
            'index.s1.th.field': 'Field',
            'index.s1.th.desc': 'Description',
            'index.s1.billing_npi': 'NPI of the provider that issued the invoice',
            'index.s1.servicing_npi': 'NPI of the provider that delivered the service',
            'index.s1.hcpcs': 'Medical procedure code (Healthcare Common Procedure Coding System)',
            'index.s1.month': 'Claim reference month (YYYY-MM)',
            'index.s1.paid': 'Total amount paid ($)',
            'index.s1.claims': 'Number of claims',
            'index.s1.bene': 'Number of unique beneficiaries',
            'index.s1.preproc': 'Preprocessing',
            'index.s1.preproc.text': 'Raw data is loaded into an analytical database (DuckDB) and pre-aggregated into 7 optimized tables for analysis:',
            'index.s1.agg1': '<strong>agg_provider_monthly</strong> &mdash; Monthly spending per provider',
            'index.s1.agg2': '<strong>agg_provider_hcpcs</strong> &mdash; Spending per provider &times; procedure, with derived metrics (cost/claim, cost/beneficiary, claims/beneficiary)',
            'index.s1.agg3': '<strong>agg_hcpcs_stats</strong> &mdash; Statistics per procedure (mean, std, median, Q1, Q3) calculated across all providers with &ge;5 providers per HCPCS',
            'index.s1.agg4': '<strong>agg_billing_servicing</strong> &mdash; Billing/servicing relationships and mismatch percentages',
            'index.s1.agg5': '<strong>agg_benford</strong> &mdash; First digit distribution of amounts per provider and HCPCS',
            'index.s1.agg6': '<strong>agg_provider_summary</strong> &mdash; Overall profile of each provider',
            'index.s1.agg7': '<strong>provider_risk_scores</strong> &mdash; Composite risk scores (calculated by the system)',
            'index.s1.filters': 'Filters applied: <code>TOTAL_PAID &gt; 0</code>, <code>TOTAL_CLAIMS &gt; 0</code>, <code>BILLING_PROVIDER_NPI_NUM IS NOT NULL</code>.',

            // Section 2: Architecture
            'index.s2.title': '2. System Architecture',
            'index.s2.intro': 'The system follows a <strong>pre-compute + static site</strong> architecture:',
            'index.s2.step1': '<strong>Ingestion</strong> &mdash; The raw CSV (~11 GB) is loaded into DuckDB with creation of aggregate tables and indexes.',
            'index.s2.step2': '<strong>Risk Score Calculation</strong> &mdash; 8 risk components are calculated and normalized to percentile (0-100) for each provider.',
            'index.s2.step3': '<strong>Pre-computation</strong> &mdash; All analyses are run in parallel (7 concurrent sections + 50 provider details) and saved as JSON files.',
            'index.s2.step4': '<strong>Static Site</strong> &mdash; HTML pages load the JSON files and visualize them with Plotly.js, Bootstrap 5 and DataTables. Zero backend, zero database in production.',
            'index.s2.perf': 'The entire pre-computation process takes approximately <strong>25 seconds</strong> on hardware with multi-core DuckDB.',

            // Section 3: Techniques
            'index.s3.title': '3. The 6 Fraud Detection Techniques',

            // 3a Benford
            'index.s3a.title': '3a. Benford\'s Law',
            'index.s3a.weight': 'Risk Score Weight: 10%',
            'index.s3a.badge': 'DISTRIBUTIONAL ANALYSIS',
            'index.s3a.text1': '<strong>Benford\'s Law</strong> (or First Digit Law) states that in many natural datasets, the leading significant digit is not uniformly distributed but follows a logarithmic distribution:',
            'index.s3a.text2': 'The digit "1" appears as the first digit in ~30.1% of cases, "2" in ~17.6%, and so on down to "9" at ~4.6%. Artificially manipulated data (fabricated amounts, rounded, or duplicated) tend to deviate from this distribution.',
            'index.s3a.metrics': 'Calculated metrics',
            'index.s3a.mad': '<strong>MAD (Mean Absolute Deviation)</strong> &mdash; Mean of absolute deviations between observed and expected frequency for each of the 9 digits. Values &gt; 0.015 are considered "non-conforming", &gt; 0.03 "significantly deviating".',
            'index.s3a.chi2': '<strong>Chi-Square Test (&chi;&sup2;)</strong> &mdash; Goodness-of-fit test with 8 degrees of freedom. A p-value &lt; 0.05 indicates statistically significant deviation from Benford\'s Law.',
            'index.s3a.levels': 'Analysis levels',
            'index.s3a.global': '<strong>Global</strong> &mdash; Overall distribution of all amounts',
            'index.s3a.hcpcs': '<strong>Per HCPCS</strong> &mdash; Each procedure analyzed separately (minimum 100 records)',
            'index.s3a.provider': '<strong>Per Provider</strong> &mdash; Each provider analyzed separately (minimum 50 records)',
            'index.s3a.interp': '<strong>Interpretation:</strong> A provider with high MAD might have non-organic amounts (fabricated, systematically rounded, or copied). However, Benford deviations can have legitimate explanations (e.g., fixed rates, system rounding). This is why Benford has a moderate weight (10%) in the composite risk score.',

            // 3b Outliers
            'index.s3b.title': '3b. Statistical Outliers',
            'index.s3b.weight': 'Weight: Z-Score 20% + Isolation Forest 15% = 35%',
            'index.s3b.badge': 'STATISTICAL ANALYSIS',
            'index.s3b.text1': 'Three complementary methods identify providers billing anomalous amounts compared to their peers for the same procedure:',
            'index.s3b.zscore.title': 'Z-Score (weight 20%)',
            'index.s3b.zscore.text1': 'Measures how many standard deviations a provider is from the mean of their procedure:',
            'index.s3b.zscore.text2': 'Providers with |Z| &gt; 3 are flagged as outliers (probability &lt; 0.3% in normal distribution). The system calculates Z-score on both <code>cost_per_claim</code> and <code>cost_per_beneficiary</code>. The risk score uses the maximum |Z| across all procedures of a provider.',
            'index.s3b.iqr.title': 'Tukey\'s IQR Method',
            'index.s3b.iqr.text1': 'Non-parametric method robust to outliers themselves. Defines the "fences":',
            'index.s3b.iqr.text2': 'Values beyond the fences are outliers. This method is complementary to Z-score because it does not assume normality.',
            'index.s3b.if.title': 'Isolation Forest (weight 15%)',
            'index.s3b.if.text1': 'Unsupervised machine learning algorithm (decision tree ensemble). Isolates anomalous observations: points that are easy to isolate (few splits needed) are more anomalous.',
            'index.s3b.if.feat1': 'Features used: <code>cost_per_claim</code>, <code>cost_per_beneficiary</code>, <code>claims_per_beneficiary</code>, <code>total_paid</code>',
            'index.s3b.if.feat2': 'Log transformation to handle skewness',
            'index.s3b.if.feat3': 'Contamination = 5% (the model expects ~5% of data to be anomalous)',
            'index.s3b.interp': '<strong>Interpretation:</strong> Providers flagged by all three methods have a very high probability of having anomalous billing patterns. Causes can include upcoding (billing more expensive procedures than those delivered), unbundling (splitting a procedure into multiple claims), or direct fraud.',

            // 3c Billing
            'index.s3c.title': '3c. Billing Mismatch',
            'index.s3c.weight': 'Risk Score Weight: 10%',
            'index.s3c.badge': 'RELATIONAL ANALYSIS',
            'index.s3c.text1': 'Analyzes discrepancies between the <strong>billing NPI</strong> (who issues the invoice) and the <strong>servicing NPI</strong> (who delivers the service). In legitimate scenarios, the billing NPI may be a medical group or facility. In fraudulent scenarios, a single NPI may bill for dozens of non-existent providers.',
            'index.s3c.indicators': 'Indicators',
            'index.s3c.hubs': '<strong>Billing Hubs</strong> &mdash; Billing NPIs associated with many different servicing NPIs. A billing NPI with 10+ servicing NPIs is suspicious.',
            'index.s3c.pctmm': '<strong>% Mismatch</strong> &mdash; Percentage of spending where billing &ne; servicing. High percentage suggests anomalous intermediation.',
            'index.s3c.lorenz': '<strong>Lorenz Curve</strong> &mdash; Measures concentration: if few providers generate most of the mismatch, the pattern is more suspicious.',
            'index.s3c.network.title': 'Billing-Servicing Network',
            'index.s3c.network.text': 'Relationships are visualized as a graph where nodes are NPIs and edges represent cross-billing. Central nodes with many connections ("hubs") are potential points of organized fraud.',
            'index.s3c.interp': '<strong>Interpretation:</strong> Mismatch per se is not illegal (e.g., laboratories, medical groups). It becomes suspicious when combined with high volumes, few months of activity, and anomalous costs.',

            // 3d Temporal
            'index.s3d.title': '3d. Temporal Anomalies',
            'index.s3d.weight': 'Weight: Spike 15% + Ghost 10% = 25%',
            'index.s3d.badge': 'TIME SERIES ANALYSIS',
            'index.s3d.text1': 'Four sub-analyses examine the temporal behavior of each provider:',
            'index.s3d.spike.title': 'Spike Detection (weight 15%)',
            'index.s3d.spike.text1': 'Identifies sudden month-over-month spending increases:',
            'index.s3d.spike.text2': 'A provider with a &gt;300% increase in one month is flagged. The system also calculates a rolling Z-score (6-month window) to contextualize the spike relative to the provider\'s historical volatility.',
            'index.s3d.ghost.title': 'Ghost Providers (weight 10%)',
            'index.s3d.ghost.text1': 'Providers active for a very brief period but with high billing:',
            'index.s3d.ghost.rule1': '&le; 3 months + &ge; $500K &rarr; Score 100 (maximum risk)',
            'index.s3d.ghost.rule2': '&le; 6 months + &ge; $500K &rarr; Score 80',
            'index.s3d.ghost.rule3': '&le; 6 months + &ge; $100K &rarr; Score 50',
            'index.s3d.ghost.rule4': '&le; 12 months + &ge; $500K &rarr; Score 30',
            'index.s3d.ghost.text2': 'This "hit-and-run" pattern is one of the strongest fraud indicators: the provider appears, quickly bills high amounts, and disappears before controls can be activated.',
            'index.s3d.disapp.title': 'Disappeared Providers',
            'index.s3d.disapp.text': 'Providers that stopped activity at least 6 months before the end of data, with at least $100K in billing and 3+ months of activity. Sudden disappearance may indicate closure following investigations or flight after fraudulent activity.',
            'index.s3d.seasonal.title': 'Seasonal Deviations',
            'index.s3d.seasonal.text': 'Months where a provider\'s spending deviates &gt;2 standard deviations from their own historical average. Requires at least 6 months of activity.',

            // 3e Volume
            'index.s3e.title': '3e. Volume Anomalies',
            'index.s3e.weight': 'Weight: Claims/Bene 10% + Concentration 10% = 20%',
            'index.s3e.badge': 'VOLUMETRIC ANALYSIS',
            'index.s3e.text1': 'Two indicators analyze activity volumes:',
            'index.s3e.cpb.title': 'Claims per Beneficiary (weight 10%)',
            'index.s3e.cpb.text1': 'Ratio between a provider\'s number of claims for a procedure and the median of the same procedure across all providers:',
            'index.s3e.cpb.text2': 'A ratio &gt; 3x indicates the provider is generating a disproportionate number of claims per beneficiary compared to peers. May indicate <strong>unbundling</strong> (splitting a procedure into multiple separate claims) or <strong>phantom billing</strong> (claims for services never rendered).',
            'index.s3e.hhi.title': 'Procedure Concentration - HHI Index (weight 10%)',
            'index.s3e.hhi.text1': 'The Herfindahl-Hirschman Index measures how concentrated a provider\'s billing is on few procedures:',
            'index.s3e.hhi.rule1': 'HHI = 1.0 &rarr; 100% of spending on a single procedure',
            'index.s3e.hhi.rule2': 'HHI &gt; 0.8 &rarr; Extreme concentration (suspicious)',
            'index.s3e.hhi.rule3': 'HHI &lt; 0.25 &rarr; Diversified (typical of legitimate practices)',
            'index.s3e.hhi.text2': 'A provider billing millions on a single procedure is more suspicious than one with a diversified mix, especially when combined with anomalous cost per claim.',

            // 3f Risk Score
            'index.s3f.title': '3f. Composite Risk Score',
            'index.s3f.weight': 'Scale 0-100',
            'index.s3f.badge': 'AGGREGATE SCORE',
            'index.s3f.text1': 'Each provider receives a composite risk score (0-100) that combines all previous analyses. Each component is first <strong>normalized to percentile</strong> (rank percentile 0-100 across the entire population) and then weighted:',
            'index.s3f.th.component': 'Component',
            'index.s3f.th.weight': 'Weight',
            'index.s3f.th.metric': 'Base metric',
            'index.s3f.m1': 'MAX(|Z-score|) across all procedures',
            'index.s3f.m2': 'Normalized anomaly score',
            'index.s3f.m3': 'MAX month-over-month spike',
            'index.s3f.m4': 'MAD from expected distribution',
            'index.s3f.m5': '% spending with billing &ne; servicing',
            'index.s3f.m6': 'Heuristic (months &times; billing)',
            'index.s3f.m7': 'MAX ratio vs HCPCS median',
            'index.s3f.m8': 'HHI of procedure mix',
            'index.s3f.threshold': '<strong>High risk threshold: &ge; 70/100.</strong> Providers above this threshold show significant anomalies across multiple dimensions simultaneously.',
            'index.s3f.percentile': '<strong>Note on percentile normalization:</strong> A percentile of 95 means the provider has a higher value than 95% of the population for that metric. This makes components comparable even if they have very different scales (e.g., dollars vs ratios).',

            // Section 4: Results
            'index.s4.title': '4. Key Findings',
            'index.s4.r1.title': '18,612 high-risk providers (3.1%)',
            'index.s4.r1.text': 'Out of 594,244 analyzed providers, 18,612 have a risk score &ge; 70, indicating consistent anomalies across multiple dimensions. The mean risk score is 47.1, the median 47.1 &mdash; approximately normal distribution centered at mid-scale.',
            'index.s4.r2.title': 'Benford: global compliance, local deviations',
            'index.s4.r2.text': 'The &chi;&sup2; test is significant (&chi;&sup2; = 227,151, p &asymp; 0) but purely due to sample size effect (~190M observations). The <strong>global MAD is 0.0034</strong>, indicating <strong>strict conformity</strong> to Benford (Nigrini threshold: &lt;0.006). The aggregate distribution is substantially normal. Deviations are concentrated on specific providers and HCPCS codes: 200 providers and 200 codes show elevated MAD, suggesting non-organic amount patterns at the local level.',
            'index.s4.r3.title': '200 Ghost Providers with "hit-and-run" pattern',
            'index.s4.r3.text': '200 providers were active for 6 months or less with billing exceeding $500K. The most striking case: a single provider billed $48.3M in just 6 months (July-December 2022) before ceasing activity.',
            'index.s4.r4.title': '$320 billion (29.3%) in billing mismatch',
            'index.s4.r4.text': '24.5% of providers (145,485) have discrepancies between billing NPI and servicing NPI, totaling $320 billion. The top "billing hubs" manage relationships with dozens of servicing NPIs each.',
            'index.s4.r5.title': 'Providers with extreme concentration',
            'index.s4.r5.text': 'Numerous high-billing providers operate on a single procedure (HHI = 1.0) with cost per claim far above average. This pattern is consistent with systematic upcoding or specialization in high-reimbursement procedures.',

            // Section 5: Conclusions
            'index.s5.title': '5. Conclusions and Investigative Hypotheses',
            'index.s5.intro': 'The multidimensional analysis conducted on 594,244 providers and over $1 trillion in Medicaid payments revealed statistically anomalous patterns that, considered as a whole, outline concrete investigative hypotheses.',
            'index.s5.h1.title': 'Hypothesis 1: Organized fictitious billing network through Billing Hubs',
            'index.s5.h1.text': '<p>The provider with the most associated servicing NPIs (NPI 1679525919) manages <strong>5,716 servicing NPIs</strong> for a total of <strong>$863 million</strong> in billing. The top 3 billing hubs alone channel over <strong>$1.37 billion</strong>.</p><p>24.5% of providers (145,485) show discrepancies between billing NPI and servicing NPI, totaling <strong>$320 billion</strong> (29.3% of total spending). 35.3% of total claims flow through these channels.</p><p><strong>Hypothesis:</strong> Some billing hubs may function as "shell entities" that aggregate billing on behalf of fictitious or non-existent providers. The abnormal number of servicing NPIs associated with a single billing NPI suggests an organizational model designed to fragment and make less visible the overall billing volume. This scheme is consistent with documented patterns of <em>billing mill fraud</em>.</p><p class="mb-0"><strong>Suggested action:</strong> Cross-reference the top 200 billing hubs with the NPPES registry to verify that servicing NPIs correspond to real, active professionals with verifiable physical addresses.</p>',
            'index.s5.h2.title': 'Hypothesis 2: "Ghost Providers" with hit-and-run scheme',
            'index.s5.h2.text': '<p>200 providers were active for <strong>6 months or less</strong> with billing exceeding $500K. The most significant case: NPI 1922733641 billed <strong>$48.3 million in 6 months</strong> (July-December 2022, average cost per claim: $666) before ceasing activity. A second provider (NPI 1215634928) billed $22.3 million in 6 months.</p><p><strong>Hypothesis:</strong> The pattern of "high intensity in a short time window followed by sudden cessation" is a classic indicator of <em>phantom billing</em>. The provider is registered, bills intensively for a few months &mdash; typically below the annual audit threshold &mdash; and then disappears before controls can be activated. The concentration of many ghost providers in the 2022-2023 period suggests a possible systematic pattern rather than isolated cases.</p><p class="mb-0"><strong>Suggested action:</strong> Analyze the beneficiaries associated with these providers to verify if the same patients appear under other ghost NPIs, which would indicate a <em>patient recycling</em> circuit.</p>',
            'index.s5.h3.title': 'Hypothesis 3: Systematic upcoding on high-reimbursement procedures',
            'index.s5.h3.text': '<p>Providers with HHI concentration index near 1.0 (single-procedure) generate billing in the <strong>billions</strong>: NPI 1376609297 has an HHI of 0.96 with $5.57 billion on essentially one procedure. The top 3 providers by concentration bill a combined $10.28 billion.</p><p>In parallel, Z-Score and IQR analysis identifies thousands of outliers for procedures T1019, T1015, T2016 and 99213 &mdash; procedures frequently associated with <em>home health services</em> and outpatient visits.</p><p><strong>Hypothesis:</strong> The combination of extreme concentration on a single procedure and average cost per claim significantly above the procedure average is consistent with <em>upcoding</em> (billing a procedure at a higher complexity/reimbursement level than actually delivered) or <em>unbundling</em> (splitting a service into multiple separate claims to maximize reimbursement).</p><p class="mb-0"><strong>Suggested action:</strong> Compare HCPCS codes billed by these providers with their registered medical specialty. A dermatologist billing exclusively for high-cost cardiovascular procedures, for example, would constitute an unequivocal "red flag".</p>',
            'index.s5.h4.title': 'Hypothesis 4: Amount manipulation (Benford deviation)',
            'index.s5.h4.text': '<p>The global first digit distribution significantly deviates from Benford\'s Law (&chi;&sup2; = 227,151, p &asymp; 0). The 200 providers with the greatest deviation (MAD > 0.19) show first digit distributions radically different from expected, with over-representation of specific digits.</p><p><strong>Hypothesis:</strong> Fabricated or manipulated amounts tend not to follow Benford\'s natural distribution. A provider billing repetitive amounts (e.g., always $999, $4,500, $8,000) generates a "flat" or concentrated first digit distribution, clearly distinguishable from an organic distribution. This pattern is particularly relevant when it coincides with other risk indicators (ghost provider, high concentration, temporal spikes).</p><p class="mb-0"><strong>Suggested action:</strong> Audit raw claims for providers with MAD > 0.15 to check for repetitive amounts, suspicious rounding, or clusters of identical amounts.</p>',
            'index.s5.h5.title': 'Hypothesis 5: Multi-dimensional convergence as prioritization',
            'index.s5.h5.text': '<p>The highest-risk provider (NPI 1972688919, score 89.8/100) shows anomalies <strong>across all 8 dimensions simultaneously</strong>: Benford (69.5), Z-Score (98.2), Isolation Forest (99.4), Billing Mismatch (87.4), Temporal Spike (93.8), Ghost Provider (99.4), Claims/Beneficiary (95.3), Concentration (60.1). Its total billing is $52.1 million.</p><p>The top 5 providers by risk score all have scores above 88.9 and accumulate approximately $145 million in billing.</p><p><strong>Conclusion:</strong> The probability that a single provider is anomalous across 8 independent dimensions by pure chance is extremely low. The convergence of multiple indicators constitutes the strongest basis for audit prioritization. The 18,612 providers with score &ge; 70 (3.1% of total) should be the primary target of in-depth investigations.</p><p class="mb-0"><strong>Estimated potential impact:</strong> If even just 10% of the $320 billion in billing mismatch is attributable to improper billing, that would be approximately <strong>$32 billion</strong> in potential waste or fraud.</p>',

            // Section 6: Limitations
            'index.s6.title': '6. Analysis Limitations',
            'index.s6.subtitle': 'What this analysis is NOT',
            'index.s6.l1': '<strong>It is not proof of fraud.</strong> Every statistical anomaly may have legitimate explanations: a single-procedure provider could be a specialized center; a ghost provider may have simply closed business; a billing hub could be a legitimate hospital group.',
            'index.s6.l2': '<strong>It does not consider clinical variables.</strong> The analysis is based exclusively on aggregated billing data. We have no access to diagnoses, medical records, or patient outcomes.',
            'index.s6.l3': '<strong>Data is aggregated by provider-procedure-month.</strong> We have no visibility into individual claims or individual beneficiaries, which limits analysis granularity.',
            'index.s6.l4': '<strong>Benford\'s Law has known limitations.</strong> It does not apply to truncated distributions, values with limited range, or data with many zeros. Some HCPCS codes have fixed rates that naturally deviate from Benford.',
            'index.s6.l5': '<strong>Risk score weights are based on literature and expert judgment</strong>, not on a supervised model with confirmed fraud cases. A dataset of confirmed fraud would allow optimal weight calibration.',

            // Section 7: Navigation
            'index.s7.title': '7. Analysis Navigation',
            'index.s7.text': 'Each page of the site presents pre-calculated data with interactive charts (Plotly.js) and searchable, sortable tables (DataTables).',
            'index.s7.overview': 'KPIs, monthly trend, top HCPCS, top risk providers',
            'index.s7.benford': 'First digit distribution, deviations by HCPCS and provider',
            'index.s7.outliers': 'Z-Score and IQR outliers by procedure',
            'index.s7.billing': 'Mismatch, billing hubs, network, Lorenz curve',
            'index.s7.temporal': 'Spikes, ghosts, disappeared, seasonal deviations',
            'index.s7.volume': 'Claims/beneficiary, HHI concentration',
            'index.s7.risk': 'Distribution, composition, correlation',
            'index.s7.provider': 'Drill-down on top 50 risk providers',
            'index.footer': 'Analysis performed on CMS Medicaid Provider Spending data. Results are statistical indicators and do not constitute proof of fraud. Each anomaly requires in-depth investigation to determine whether it represents illicit activity or has legitimate explanations.',

            // === OVERVIEW PAGE ===
            'overview.title': 'Overview - Medicaid Fraud Detection System',
            'overview.subtitle': 'Overview of Medicaid data and providers at highest risk of fraud',
            'overview.kpi.spend': 'Total Spending',
            'overview.kpi.claims': 'Total Claims',
            'overview.kpi.providers': 'Total Providers',
            'overview.kpi.bene': 'Beneficiaries',
            'overview.kpi.risk': 'High Risk Providers',
            'overview.trend': 'Monthly Trend',
            'overview.topHcpcs': 'Top 30 HCPCS Procedures by Spending',
            'overview.topRisk': 'Top 20 Risk Providers',

            // === BENFORD PAGE ===
            'benford.title': 'Benford\'s Law Analysis',
            'benford.subtitle': 'Benford\'s Law predicts that the first digit of amounts follows a logarithmic distribution. Significant deviations may indicate data manipulation.',
            'benford.global': 'Global First Digit Distribution',
            'benford.topHcpcs': 'Top HCPCS by Deviation (MAD)',
            'benford.topProviders': 'Top Providers by Deviation (MAD)',
            'benford.chi2.significant': 'Statistically significant deviation',
            'benford.chi2.compatible': 'Compatible with Benford',
            'benford.mad.strict': 'Strict conformity',
            'benford.mad.acceptable': 'Acceptable conformity',
            'benford.mad.marginal': 'Marginal conformity',
            'benford.mad.nonconform': 'Non-conforming',
            'benford.chi2.note': 'Note: the &chi;&sup2; test is significant due to sample size effect (~190 million observations). With such large samples, even minimal deviations produce p-values close to zero. MAD is the most appropriate metric for evaluating Benford conformity on large datasets: the value of {mad} indicates that the global distribution is substantially conforming. Relevant deviations are concentrated on specific providers, not the aggregate dataset.',

            // === OUTLIERS PAGE ===
            'outliers.title': 'Statistical Outliers by Procedure',
            'outliers.subtitle': 'Providers with anomalous costs relative to their HCPCS procedure distribution (Z-Score > 3 and Tukey\'s IQR method)',
            'outliers.summary': 'Outlier Summary by Top HCPCS',
            'outliers.tab.zscore': 'Z-Score Outliers',
            'outliers.tab.iqr': 'IQR Outliers',

            // === BILLING PAGE ===
            'billing.title': 'Billing Mismatch Analysis',
            'billing.subtitle': 'Analysis of discrepancies between billing NPI and servicing NPI. Providers with many associated servicing NPIs may indicate fraudulent schemes.',
            'billing.kpi.mismatch': 'Providers with Mismatch',
            'billing.kpi.amount': 'Mismatch Amount',
            'billing.kpi.claims': 'Mismatch Claims',
            'billing.topHubs': 'Top Billing Hubs',
            'billing.network': 'Billing-Servicing Network',
            'billing.lorenz': 'Lorenz Curve - Mismatch Concentration',

            // === TEMPORAL PAGE ===
            'temporal.title': 'Temporal Anomalies',
            'temporal.subtitle': 'Detection of sudden spikes, ghost providers, disappeared providers, and seasonal deviations',
            'temporal.tab.spikes': 'Spikes',
            'temporal.tab.ghosts': 'Ghost Providers',
            'temporal.tab.disappeared': 'Disappeared',
            'temporal.tab.seasonal': 'Seasonality',

            // === VOLUME PAGE ===
            'volume.title': 'Volume Anomalies',
            'volume.subtitle': 'Providers with anomalous claims/beneficiary ratios and excessive concentration on single procedures (HHI)',
            'volume.tab.cpb': 'Claims/Beneficiary',
            'volume.tab.hhi': 'HHI Concentration',

            // === RISK PAGE ===
            'risk.title': 'Provider Risk Score',
            'risk.subtitle': 'Composite score 0-100 based on 8 components. Providers with score &ge;70 are considered high risk.',
            'risk.distribution': 'Risk Score Distribution',
            'risk.top10': 'Top 10 Providers - Score Composition',
            'risk.ranking': 'Full Ranking',
            'risk.correlation': 'Component Correlation',
            'risk.threshold': 'High Risk Threshold',

            // === PROVIDER PAGE ===
            'provider.title': 'Provider Detail',
            'provider.subtitle': 'In-depth analysis of the top 50 risk providers',
            'provider.select.label': 'Select Provider NPI:',
            'provider.select.loading': 'Loading...',
            'provider.select.placeholder': '-- Select NPI --',
            'provider.noSelection': 'Select a provider from the menu to view its detail',
            'provider.kpi.spend': 'Total Spending',
            'provider.kpi.claims': 'Claims',
            'provider.kpi.bene': 'Beneficiaries',
            'provider.kpi.hcpcs': 'HCPCS Procedures',
            'provider.kpi.months': 'Active Months',
            'provider.risk': 'Risk Score Breakdown',
            'provider.timeline': 'Monthly Timeline',
            'provider.procedures': 'Procedure Breakdown',
            'provider.benford': 'Benford Analysis',
            'provider.network': 'Billing-Servicing Network',
            'provider.dataUnavailable': 'Data unavailable for this provider',
            'provider.benfordUnavailable': 'Benford data unavailable',
            'provider.score.total': 'Total Score:',
            'provider.mismatch.npis': 'Servicing NPIs',
            'provider.mismatch.pct': '% Spending Mismatch',
            'provider.mismatch.amount': 'Mismatch $',

            // === CHARTS ===
            'chart.observed': 'Observed',
            'chart.expected': 'Benford expected',
            'chart.benford.title': 'First Digit Distribution vs Benford\'s Law',
            'chart.benford.xaxis': 'First Digit',
            'chart.benford.yaxis': 'Relative Frequency',
            'chart.lorenz.title': 'Lorenz Curve - Mismatch Concentration',
            'chart.lorenz.xaxis': '% Cumulative Providers',
            'chart.lorenz.yaxis': '% Cumulative Mismatch Amount',
            'chart.lorenz.equality': 'Perfect equality',
            'chart.network.title': 'Billing-Servicing Network',
            'chart.network.connections': 'Connections',
            'chart.outliers.title': 'Outlier Count by HCPCS',
            'chart.spikes.title': 'Monthly Spikes: Spending vs % Change',
            'chart.ghosts.title': 'Ghost Providers: Active Months vs Spending',
            'chart.seasonal.title': 'Seasonal Deviations (|Z| > 2)',
            'chart.cpb.title': 'Claims/Beneficiary: Ratio vs Median vs Spending',
            'chart.hhi.title': 'HHI (Procedure Concentration) vs Total Spending',
            'chart.trend.title': 'Total Monthly Spending',
            'chart.risk.count': 'Count',

            // === TABLES ===
            'table.search': 'Search:',
            'table.lengthMenu': 'Show _MENU_ rows',
            'table.info': '_START_ - _END_ of _TOTAL_',
            'table.first': 'First',
            'table.last': 'Last',
            'table.next': '>',
            'table.previous': '<',

            // Table column labels
            'col.billing_npi': 'Billing NPI',
            'col.servicing_npi': 'Servicing NPI',
            'col.hcpcs': 'HCPCS Code',
            'col.month': 'Month',
            'col.total_paid': 'Total Spending',
            'col.total_claims': 'Total Claims',
            'col.total_beneficiaries': 'Beneficiaries',
            'col.total_records': 'Total Records',
            'col.num_providers': 'No. Providers',
            'col.num_hcpcs': 'No. Procedures',
            'col.num_months': 'No. Months',
            'col.num_servicing_npis': 'No. Servicing NPIs',
            'col.cost_per_claim': 'Cost/Claim',
            'col.cost_per_beneficiary': 'Cost/Beneficiary',
            'col.claims_per_beneficiary': 'Claims/Beneficiary',
            'col.avg_cost_per_claim': 'Avg Cost/Claim',
            'col.std_cost_per_claim': 'Std Cost/Claim',
            'col.z_cost_per_claim': 'Z-Score Cost/Claim',
            'col.z_cost_per_beneficiary': 'Z-Score Cost/Bene',
            'col.mad': 'MAD',
            'col.chi2': 'Chi-Square',
            'col.p_value': 'P-Value',
            'col.total_risk_score': 'Risk Score',
            'col.benford_score': 'Benford',
            'col.zscore_severity': 'Z-Score',
            'col.isolation_forest_score': 'Isolation Forest',
            'col.billing_mismatch_score': 'Mismatch',
            'col.temporal_spike_score': 'Spike',
            'col.ghost_provider_score': 'Ghost',
            'col.claims_per_bene_score': 'Claims/Bene',
            'col.concentration_score': 'Concentration',
            'col.pct_mismatch_paid': '% Mismatch $',
            'col.pct_mismatch_claims': '% Mismatch Claims',
            'col.mismatch_paid': 'Mismatch $',
            'col.mismatch_claims': 'Mismatch Claims',
            'col.mom_change_pct': 'MoM Change %',
            'col.rolling_zscore': 'Rolling Z-Score',
            'col.hhi': 'HHI',
            'col.max_share': 'Max Share',
            'col.top_hcpcs': 'Top HCPCS',
            'col.ratio_to_median': 'Ratio vs Median',
            'col.first_month': 'First Month',
            'col.last_month': 'Last Month',
            'col.months_since_last': 'Months Inactive',
            'col.zscore': 'Z-Score',
            'col.avg_paid': 'Avg Spending',
            'col.std_paid': 'Std Spending',
            'col.z_outlier_count': 'Z Outlier Count',
            'col.iqr_outlier_count': 'IQR Outlier Count',
            'col.share': 'Share %',
            'col.observed_pct': '% Observed',
            'col.expected_pct': '% Expected',
            'col.deviation': 'Deviation',
            'col.prev_paid': 'Prev. Spending',
            'col.rolling_avg': 'Rolling Avg',
            'col.avg_cost_per_claim_y': 'Avg Cost/Claim',
            'col.data_end': 'Data End',
        },
    },

    t(key) {
        return this.translations[this.currentLang]?.[key]
            || this.translations['it']?.[key]
            || key;
    },

    setLang(lang) {
        this.currentLang = lang;
        localStorage.setItem('lang', lang);
        document.documentElement.lang = lang;
        this.applyAll();
        // Update toggle button text
        document.querySelectorAll('.lang-toggle').forEach(btn => {
            btn.textContent = lang === 'it' ? 'EN' : 'IT';
        });
        // Dispatch event for pages that need to re-render dynamic content
        window.dispatchEvent(new CustomEvent('langchange', { detail: { lang } }));
    },

    applyAll() {
        document.querySelectorAll('[data-i18n]').forEach(el => {
            el.textContent = this.t(el.dataset.i18n);
        });
        document.querySelectorAll('[data-i18n-html]').forEach(el => {
            el.innerHTML = this.t(el.dataset.i18nHtml);
        });
    },

    toggle() {
        this.setLang(this.currentLang === 'it' ? 'en' : 'it');
    },

    init() {
        document.documentElement.lang = this.currentLang;
        this.applyAll();
        document.querySelectorAll('.lang-toggle').forEach(btn => {
            btn.textContent = this.currentLang === 'it' ? 'EN' : 'IT';
        });
    },

    // Helper: get column label
    colLabel(fieldName) {
        const key = 'col.' + fieldName;
        const val = this.translations[this.currentLang]?.[key];
        return val || fieldName;
    },

    // Helper: DataTables language object
    dtLanguage() {
        return {
            search: this.t('table.search'),
            lengthMenu: this.t('table.lengthMenu'),
            info: this.t('table.info'),
            paginate: {
                first: this.t('table.first'),
                last: this.t('table.last'),
                next: this.t('table.next'),
                previous: this.t('table.previous'),
            },
        };
    },
};
